buildscript {
    repositories {
        mavenCentral()
        mavenLocal()
    }
    dependencies {
        classpath 'org.almibe:naps:0.0.1-SNAPSHOT'
    }
}

apply plugin: 'naps'

naps {
    defaultTemplate = 'index.html'
    globalVariables = ['title':'Title']
    contentGroups {
        mainPage {
            mainContent = 'index.md'
//            variables = ['title':"This is the title"]
        }
//        articles {
//            mainContent = 'index.html'
//            variables = ['title':"This is the title?!?!?!?!?!?!?!?!?!?!?"]
//        }
    }
}

task test(dependsOn: ":naps") << {
    def expectedFiles = getAllFiles('src/test/expected')
    def napsFiles = getAllFiles('build/naps/site')

}

task clean() << {
    //TODO delete build -- or should this be in root project?
}

def getAllFiles(String directory) {
    def result = [:]
    def fileTree = project.fileTree(dir:directory)
    def rootLocation = fileTree.dir.absolutePath
    println "Root : $rootLocation"
    fileTree.forEach {
        result.put(it.absolutePath - rootLocation, it)
    }
    return result
}